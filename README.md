# Beer Tap Management System

Система управления пивными кранами с использованием SQLite базы данных и Telegram бота.

## Описание

Проект предоставляет два интерфейса для управления информацией о пивных кранах:
- Консольное приложение для локального управления
- Telegram бот для удаленного управления и просмотра информации

## Структура проекта

```
SqlLite-Beers/
├── beer_database.py        # Модуль работы с базой данных
├── telegram_bot.py         # Логика Telegram бота
├── bot_config.py           # Управление конфигурацией
├── run_bot.py              # Запуск бота
├── setup_bot.py            # Настройка конфигурации
├── main.py                 # Консольное приложение
├── requirements.txt        # Зависимости проекта
├── .env.example            # Шаблон конфигурации
├── .gitignore              # Игнорируемые файлы
└── README.md               # Документация
```

## Требования

- Python 3.11+
- pip для установки зависимостей
- Telegram аккаунт для использования бота

## Установка

### Шаг 1: Клонирование репозитория

```bash
git clone https://github.com/your-username/SqlLite-Beers.git
cd SqlLite-Beers
```

### Шаг 2: Установка зависимостей

```bash
pip install -r requirements.txt
```

### Шаг 3: Настройка конфигурации

Вариант A: Автоматическая настройка

```bash
python3 setup_bot.py
```

Скрипт запросит:
- Токен Telegram бота (получите у @BotFather)
- ID администраторов (узнайте у @userinfobot)

Вариант B: Ручная настройка

```bash
cp .env.example .env
```

Откройте `.env` и заполните:

```
TELEGRAM_BOT_TOKEN=your_bot_token_here
ADMIN_IDS=123456789,987654321
```

ВАЖНО: Файл `.env` содержит конфиденциальные данные и не должен попадать в систему контроля версий.

## Использование

### Запуск Telegram бота

```bash
python3 run_bot.py
```

### Запуск консольного приложения

```bash
python3 main.py
```

## Функциональность

### Telegram бот

Команды для всех пользователей:
- `/start` - Инициализация бота и отображение главного меню
- `/help` - Справка по доступным командам
- `/taps` - Просмотр всех кранов с текущим пивом
- `/find <номер>` - Поиск пива по номеру крана

Команды для администраторов:
- `/admin` - Панель администратора
- Добавление нового пива с интеграцией Untappd
- Редактирование существующих записей
- Удаление пива из кранов
- Просмотр истории добавленных пив

Особенности:
- Интеграция с Untappd для автоматического получения данных о пиве
- Автоматическое заполнение ABV и IBU
- История добавленных пив с возможностью быстрого повторного добавления
- Интерактивный выбор пива из нескольких вариантов

### Консольное приложение

Доступные операции:
- Просмотр всех кранов
- Поиск по номеру крана
- Добавление нового пива
- Обновление информации о пиве
- Удаление пива из крана
- Статистика по кранам

## Структура базы данных

### Таблица beer_taps

| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER | Первичный ключ |
| tap_position | INTEGER | Номер крана (уникальный) |
| brewery | TEXT | Название пивоварни |
| name | TEXT | Название пива |
| style | TEXT | Стиль пива |
| price_per_liter | REAL | Цена за литр |
| description | TEXT | Описание пива |
| cost_400ml | REAL | Стоимость 400 мл |
| cost_250ml | REAL | Стоимость 250 мл |
| untappd_url | TEXT | Ссылка на Untappd |
| abv | REAL | Содержание алкоголя |
| ibu | REAL | Горечь пива |

### Таблица beer_history

| Поле | Тип | Описание |
|------|-----|----------|
| id | INTEGER | Первичный ключ |
| brewery | TEXT | Название пивоварни |
| name | TEXT | Название пива |
| style | TEXT | Стиль пива |
| description | TEXT | Описание пива |
| untappd_url | TEXT | Ссылка на Untappd |
| abv | REAL | Содержание алкоголя |
| ibu | REAL | Горечь пива |
| added_count | INTEGER | Количество добавлений |
| last_added | TEXT | Дата последнего добавления |

## Безопасность

### Конфиденциальные данные

Проект использует переменные окружения для хранения чувствительной информации:
- Токен Telegram бота
- ID администраторов

Файл `.env` автоматически игнорируется Git через `.gitignore`.

### Проверка перед загрузкой на GitHub

```bash
# Проверка что .env игнорируется
git check-ignore .env

# Проверка статуса файлов
git status

# Проверка отсутствия токенов в коде
grep -r "TELEGRAM_BOT_TOKEN" --include="*.py" . | grep -v ".env"
```

### Для разработчиков

После клонирования репозитория:

1. Создайте файл `.env` из шаблона
2. Заполните свои данные
3. Не коммитьте `.env` в репозиторий

Подробная инструкция: см. `GITHUB_UPLOAD.md`

## Технические детали

### Технологии

- Язык: Python 3.11+
- База данных: SQLite3
- Telegram API: python-telegram-bot 20.0+
- HTTP запросы: requests
- Парсинг: регулярные выражения

### Архитектура

- Модульная структура с разделением ответственности
- Класс BeerDatabase для работы с базой данных
- Класс BeerBot для логики Telegram бота
- Класс BotConfig для управления конфигурацией
- ConversationHandler для многошаговых диалогов

### Стандарты кода

- Соответствие PEP8
- Типизация с использованием type hints
- Докстринги в стиле Google
- Обработка исключений
- Логирование операций

## Зависимости

Основные библиотеки (см. requirements.txt):

```
python-telegram-bot>=20.0
requests>=2.31.0
```

## Примеры использования

### Добавление пива через бота

```
Пользователь: /admin
Бот: [Панель администратора]

Пользователь: [Добавить пиво]
Бот: Введите номер крана (1-30):

Пользователь: 5
Бот: Введите название пивоварни:

Пользователь: Brewery Name
Бот: [Отображает варианты из Untappd]

Пользователь: [Выбирает вариант]
Бот: Введите стиль пива:

Пользователь: IPA
Бот: Введите цену за литр:

Пользователь: 500
Бот: Введите описание:

Пользователь: Описание пива
Бот: Пиво успешно добавлено!
```

### Просмотр кранов

```
Пользователь: /taps
Бот:
ТЕКУЩИЕ КРАНЫ:

Кран 5:
Пивоварня: Brewery Name
Название: Beer Name
Стиль: IPA
ABV: 6.5%
IBU: 45
Цена: 500.00 руб/л
Untappd: [ссылка]
```

## Разработка

### Принципы

- Clean Code
- DRY (Don't Repeat Yourself)
- SOLID принципы
- Модульность
- Тестируемость

### Добавление новых функций

1. Создайте новую ветку
2. Реализуйте функциональность
3. Добавьте докстринги
4. Протестируйте изменения
5. Создайте pull request

### Структура коммитов

Используйте Conventional Commits:

```
feat: добавлена новая функция
fix: исправлена ошибка
refactor: рефакторинг кода
docs: обновлена документация
test: добавлены тесты
```

## Лицензия

Проект создан в образовательных целях.

## Контакты

Для вопросов и предложений создавайте issues в репозитории.